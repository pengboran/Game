
(function(){function addLoadEvent(fn){if(typeof window.onload=='function'){var oldonload=window.onload;window.onload=function(){oldonload();fn();}}else{window.onload=fn;}}
var domReadyTime='',pageTime=new Date().getTime();;function domReady(){if(document.addEventListener){document.addEventListener('DOMContentLoaded',function(){domReadyTime=new Date().getTime();document.removeEventListener('DOMContentLoaded',arguments.callee,false);},false);}else{if(document.getElementById){document.write("<script id=\"ie-domReady\" defer='defer'src=\"//:\"><\/script>");document.getElementById('ie-domReady').onreadystatechange=function(){if(this.readyState==='complete'){domReadyTime=new Date().getTime();this.onreadystatechange=null;this.parentNode.removeChild(this);}};}}};domReady();addLoadEvent(function(){var win=window,doc=document,nav=navigator,ua=nav.userAgent,scr=win.screen,loc=win.location.href;var prtl='https:'==win.location.protocol?'https://':'http://',domain='beacon.sina.com.cn';var a_gif=prtl+domain+'/a.gif?',e_gif=prtl+domain+'/e.gif?';var uid='',webUrl=''
startTime='',prevPageClickTime='',readyTime=''
currTime=parseInt(new Date().getTime()),requestTime='';if(typeof sudaLogConfig!=="undefined"){uid=sudaLogConfig.uId!==undefined?sudaLogConfig.uId:'';webUrl=sudaLogConfig.url!==undefined?sudaLogConfig.url:'';if(typeof globalConfig!=="undefined"){startTime=globalConfig.startTime!==undefined?globalConfig.startTime:pageTime;}
prevPageClickTime=sudaLogConfig.prevPageClickTime!==undefined?sudaLogConfig.prevPageClickTime:0;}
onloadTime=currTime-startTime;readyTime=domReadyTime-startTime;requestTime=startTime-prevPageClickTime;var performance='';if(window.suda){performance='MT='+'mperform:1'+'|'+'starttime:'+prevPageClickTime+'|'+'endtime:'+startTime+'|'+'clicktime:'+requestTime;}
var sudaRef=doc.referrer.toLowerCase();var cookie_SINAGLOBAL="SINAGLOBAL",cookie_Apache="Apache",cookie_ULV="ULV",cookie_SUP="SUP";var loginUserInfo="";var sudaExt1="",sudaExt2="";var sudaInfo=[],uaTrackInfo=[];var sudaGlobalCount=0,fsudaGlobalCount=0;function getMeta(metaName,pidx){var pMeta=doc.getElementsByName(metaName);var idx=(pidx>0)?pidx:0;return(pMeta.length>idx)?pMeta[idx].content:"";}
function getSudaMeta(){var pMeta=doc.getElementsByName('sudameta');var meta=[];for(var idx=0;idx<pMeta.length;idx++){var content=pMeta[idx].content;if(content){if(content.indexOf(';')!=-1){var temps=content.split(';');for(var i=0;i<temps.length;i++){var temp=trim(temps[i]);if(!temp)continue;meta.push(temp);}}else{meta.push(content);}}}
return meta;}
function stringSplice(src,k,e,sp){if(src==""){return"";}
sp=(sp=="")?"=":sp;k+=sp;var ps=src.indexOf(k);if(ps<0){return"";}
ps+=k.length;var pe=src.indexOf(e,ps);if(pe<ps){pe=src.length;}
return src.substring(ps,pe);}
function getCookie(ckName){if(undefined==ckName||""==ckName){return"";}
return stringSplice(doc.cookie,ckName,";","");}
function setCookie(ckName,ckValue,ckDays,ckDomain){if(ckValue!=null){if((undefined==ckDomain)||(null==ckDomain)){ckDomain='sina.cn';}
if((undefined==ckDays)||(null==ckDays)||(''==ckDays)){doc.cookie=ckName+"="+ckValue+";domain="+ckDomain+";path=/";}else{var now=new Date();var time=now.getTime();time=time+86400000*ckDays;now.setTime(time);time=now.getTime();doc.cookie=ckName+"="+ckValue+";domain="+ckDomain+";expires="+now.toUTCString()+";path=/";}}}
function addEvent(sNode,sEventType,oFunc){var oElement=sNode;if(oElement==null){return false;}
sEventType=sEventType||'click';if((typeof oFunc).toLowerCase()!="function"){return;}
if(oElement.attachEvent){oElement.attachEvent('on'+sEventType,oFunc);}
else if(oElement.addEventListener){oElement.addEventListener(sEventType,oFunc,false);}
else{oElement['on'+sEventType]=oFunc;}
return true;}
function getEvent(){if(window.event!=null){return window.event;}else{if(window.event){return window.event;}
var o=arguments.callee.caller;var e;var n=0;while(o!=null&&n<40){e=o.arguments[0];if(e&&(e.constructor==Event||e.constructor==MouseEvent||e.constructor==KeyboardEvent)){return e;}
n++;o=o.caller;}
return e;}}
function fixEvent(e){e=e||getEvent();if(!e.target){e.target=e.srcElement;e.pageX=e.x;e.pageY=e.y;}
if(typeof e.layerX=='undefined')
e.layerX=e.offsetX;if(typeof e.layerY=='undefined')
e.layerY=e.offsetY;return e;}
function trim(str){if(typeof str!=='string'){throw'trim need a string as parameter';}
var len=str.length;var s=0;var reg=/(\u3000|\s|\t|\u00A0)/;while(s<len){if(!reg.test(str.charAt(s))){break;}
s+=1;}
while(len>s){if(!reg.test(str.charAt(len-1))){break;}
len-=1;}
return str.slice(s,len);}
function isArray(o){return Object.prototype.toString.call(o)==='[object Array]';}
function queryToJson(QS,isDecode){var _Qlist=trim(QS).split("&");var _json={};var _fData=function(data){if(isDecode){return decodeURIComponent(data);}else{return data;}};for(var i=0,len=_Qlist.length;i<len;i++){if(_Qlist[i]){var _hsh=_Qlist[i].split("=");var _key=_hsh[0];var _value=_hsh[1];if(_hsh.length<2){_value=_key;_key='$nullName';}
if(!_json[_key]){_json[_key]=_fData(_value);}
else{if(isArray(_json[_key])!=true){_json[_key]=[_json[_key]];}
_json[_key].push(_fData(_value));}}}
return _json;}
function getHost(sUrl){var r=new RegExp('^http(?:s)?\://([^/]+)','im');if(sUrl.match(r)){return sUrl.match(r)[1].toString();}else{return"";}}
var CI={screenSize:function(){return scr.width+"x"+scr.height;},colorDepth:function(){return scr.colorDepth||'';},appCode:function(){return nav.appCodeName||'';},appName:function(){return(nav.appName.indexOf('Microsoft Internet Explorer')>-1)?'MSIE':nav.appName;},cpu:function(){return nav.cpuClass||nav.oscpu||"";},platform:function(){return nav.platform||'';},jsVer:function(){var p,appsign,appver,jsver=1.0,isN6=0,navigatorAppName=(nav.appName.indexOf('Microsoft Internet Explorer')>-1)?'MSIE':nav.appName,navigatorAppVersion=nav.appVersion;if('MSIE'==navigatorAppName){appsign='MSIE';p=navigatorAppVersion.indexOf(appsign);if(p>=0){appver=window.parseInt(navigatorAppVersion.substring(p+5));if(3<=appver){jsver=1.1;if(4<=appver){jsver=1.3;}}}}else if(("Netscape"==navigatorAppName)||("Opera"==navigatorAppName)||("Mozilla"==navigatorAppName)){jsver=1.3;appsign='Netscape6';p=navigatorAppVersion.indexOf(appsign);if(p>=0){jsver=1.5;}}
return jsver;},network:function(){var ct="";ct=(nav.connection&&nav.connection.type)?nav.connection.type:ct;try{doc.body.addBehavior("#default#clientCaps");ct=doc.body.connectionType;}catch(e){ct="unkown";}
return ct;},language:function(){return nav.systemLanguage||nav.language||'';},timezone:function(){return new Date().getTimezoneOffset()/60||"";},flashVer:function(){return'';},javaEnabled:function(){var pl=nav.plugins,java=nav.javaEnabled(),item,desc;if(java==true){return 1;}
if(pl&&pl.length){for(var key in pl){item=pl[key];if(item.description==null){continue;}
if(java!=null){break;}
desc=item.description.toLowerCase();if(desc.indexOf("java plug-in")!=-1){java=parseInt(item.version);continue;}}}else if(window.ActiveXObject){java=(new ActiveXObject("JavaWebStart.IsInstalled")!=null);}
return java?1:0;}};var PI={pageId:function(){return'';},sessionCount:function(){return'';},excuteCount:function(){return SUDA.sudaCount;},referrer:function(){var re=/^[^\?&#]*.swf([\?#])?/;if((sudaRef=="")||(sudaRef.match(re))){var ref=stringSplice(loc,"ref","&","");if(ref!=""){return escape(ref);}}
return escape(sudaRef);},isHomepage:function(){var isHome="";try{doc.body.addBehavior("#default#homePage");isHome=doc.body.isHomePage(loc)?"Y":"N";}catch(e){isHome="unkown";}
return isHome;},PGLS:function(){return getMeta("stencil")||"";},ZT:function(){var zt=getMeta('subjectid');zt.replace(",",".");zt.replace(";",",");return escape(zt);},mediaType:function(){return getMeta("mediaid")||"";},domCount:function(){return doc.getElementsByTagName("*").length||"";},iframeCount:function(){return doc.getElementsByTagName("iframe").length;},onloadTime:onloadTime,readyTime:readyTime,webUrl:webUrl};var UI={visitorId:function(){if(""!=cookie_SINAGLOBAL){var gid=getCookie(cookie_SINAGLOBAL);if(""==gid){gid=getCookie(cookie_Apache);var time=3650;setCookie(cookie_SINAGLOBAL,gid,time);}
return gid;}else{return"";}},sessionId:function(){var sid=getCookie(cookie_Apache);if(sid==""){var now=new Date();sid=Math.random()*10000000000000+"."+now.getTime();setCookie(cookie_Apache,sid);}
return sid;},flashCookie:function(gid){return'';},lastVisit:function(){var sid=getCookie(cookie_Apache);var lvi=getCookie(cookie_ULV);var lva=lvi.split(":");var lvr="",lvn;if(lva.length>=6){if(sid!=lva[4]){lvn=new Date();var lvd=new Date(window.parseInt(lva[0]));lva[1]=window.parseInt(lva[1])+1;if(lvn.getMonth()!=lvd.getMonth()){lva[2]=1;}else{lva[2]=window.parseInt(lva[2])+1;}
if(((lvn.getTime()-lvd.getTime())/86400000)>=7){lva[3]=1;}else{if(lvn.getDay()<lvd.getDay()){lva[3]=1;}else{lva[3]=window.parseInt(lva[3])+1;}}
lvr=lva[0]+":"+lva[1]+":"+lva[2]+":"+lva[3];lva[5]=lva[0];lva[0]=lvn.getTime();setCookie(cookie_ULV,lva[0]+":"+lva[1]+":"+lva[2]+":"+lva[3]+":"+sid+":"+lva[5],360);}else{lvr=lva[5]+":"+lva[1]+":"+lva[2]+":"+lva[3];}}else{lvn=new Date();lvr=":1:1:1";setCookie(cookie_ULV,lvn.getTime()+lvr+":"+sid+":",360);}
return lvr;},userNick:function(){if(loginUserInfo!=""){return loginUserInfo;}
var sup=unescape(getCookie(cookie_SUP)),ag='',user='',uid2=uid,sex='',bday='';if(sup!=""){ag=stringSplice(sup,"ag","&","");user=stringSplice(sup,"user","&","");uid=stringSplice(sup,"uid","&","");sex=stringSplice(sup,"sex","&","");bday=stringSplice(sup,"dob","&","");}
loginUserInfo=ag+":"+user+":"+uid2+":"+sex+":"+bday;return loginUserInfo;},userOrigin:function(){return"";},advCount:function(){return"";},subp:function(){return getCookie('SUBP');}};var D={'CI':function(){var data=['sz:'+CI.screenSize(),'dp:'+CI.colorDepth(),'ac:'+CI.appCode(),'an:'+CI.appName(),'cpu:'+CI.cpu(),'pf:'+CI.platform(),'jv:'+CI.jsVer(),'ct:'+CI.network(),'lg:'+CI.language(),'tz:'+CI.timezone(),'fv:'+CI.flashVer(),'ja:'+CI.javaEnabled()];return'CI='+data.join("|");},'PI':function(realUrl){var newUrl=PI.webUrl;if(!!realUrl){newUrl=escape(realUrl);}
var data=['pid:'+PI.pageId(),'st:'+PI.sessionCount(),'et:'+PI.excuteCount(),'ref:'+PI.referrer(),'hp:'+PI.isHomepage(),'PGLS:'+PI.PGLS(),'ZT:'+PI.ZT(),'MT:'+PI.mediaType(),'keys:','dom:'+PI.domCount(),'ifr:'+PI.iframeCount(),'nld:'+PI.onloadTime,'drd:'+PI.readyTime,'url:'+newUrl];return'PI='+data.join("|");},'UI':function(){var data=['vid:'+UI.visitorId(),'sid:'+UI.sessionId(),'lv:'+UI.lastVisit(),'un:'+UI.userNick(),'uo:'+UI.userOrigin(),'ae:'+UI.advCount(),'su:'+UI.subp(),'lu:'+'','si:'+'','rs:'+0,'dm:'+0];return'UI='+data.join("|");},'EX':function(extInfo1,extInfo2){extInfo1=(null!=extInfo1)?extInfo1||"":sudaExt1;extInfo2=(null!=extInfo2)?extInfo2||"":sudaExt2;return"EX=ex1:"+extInfo1+"|ex2:"+extInfo2;},'MT':function(){return performance;},'V':function(){return'V=2.3.1';},'R':function(){return'gUid_'+new Date().getTime();}};function sendFinalRequest(url){createRequest(url);}
function createRequest(url){var img=new Image();SUDA.img=img;img.src=url;}
function gatherCommon(ext1,ext2,realUrl){SUDA.sudaCount++;var url=a_gif+[D.V(),D.CI(),D.PI(realUrl),D.UI(),D.MT(),D.EX(ext1,ext2),D.R()].join("&");createRequest(url);}
function gatherCommon2(ext1,ext2,realUrl){if(SUDA.sudaCount!=0)
{return;}
gatherCommon(ext1,ext2,realUrl);}
function uaTrack(acode,aext,href){if(!href){href='';}else{href=escape(href);};var s="UATrack||"+getCookie(cookie_SINAGLOBAL)+"||"+getCookie(cookie_Apache)+"||"+UI.userNick()+"||"+acode+"||"+aext+"||"+PI.referrer()+"||"+href+"||";var url=e_gif+s+"&gUid_"+new Date().getTime();sendFinalRequest(url);}
function trackAgent(e){var evt=fixEvent(e);var el=evt.target;var sudaUaTrack="",href="";var trackData;if(el!=null&&el.getAttribute&&(!el.getAttribute('suda-uatrack')&&!el.getAttribute('suda-data'))){while(el!=null&&el.getAttribute&&(!!el.getAttribute('suda-uatrack')||!!el.getAttribute('suda-data'))==false){if(el==doc.body){return;}
el=el.parentNode;}}
if(el==null||el.getAttribute==null){return;}
sudaUaTrack=el.getAttribute('suda-uatrack')||el.getAttribute('suda-data')||'';if(sudaUaTrack){trackData=queryToJson(sudaUaTrack);if(el.tagName.toLowerCase()=="a"){href=el.href;}
trackData['key']&&SUDA.uaTrack&&SUDA.uaTrack(trackData['key'],trackData['value']||trackData['key'],href);}}
window.SUDA=window.SUDA||[];SUDA.sudaCount=SUDA.sudaCount||0;SUDA.log=function(){gatherCommon.apply(null,arguments);};SUDA.uaTrack=function(){uaTrack.apply(null,arguments);};addEvent(doc.body,'click',trackAgent);gatherCommon2();});})();